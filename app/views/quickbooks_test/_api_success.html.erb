<turbo-frame id="api_results">
  <div class="bg-green-50 border border-green-200 rounded-lg p-6">
    <div class="flex items-center mb-4">
      <svg class="h-5 w-5 text-green-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
      </svg>
      <h3 class="text-lg font-semibold text-green-900">API Call Successful</h3>
    </div>

    <!-- Company Info -->
    <% if @company_info && @company_info["CompanyInfo"] %>
      <div class="mb-4 p-4 bg-white rounded border border-green-200">
        <h4 class="font-semibold text-gray-900 mb-2">Company Information</h4>
        <div class="grid grid-cols-2 gap-2 text-sm">
          <span class="text-gray-600">Company Name:</span>
          <span class="text-gray-900 font-medium"><%= @company_info["CompanyInfo"]["CompanyName"] %></span>

          <% if @company_info["CompanyInfo"]["LegalName"] %>
            <span class="text-gray-600">Legal Name:</span>
            <span class="text-gray-900"><%= @company_info["CompanyInfo"]["LegalName"] %></span>
          <% end %>

          <% if @company_info["CompanyInfo"]["Country"] %>
            <span class="text-gray-600">Country:</span>
            <span class="text-gray-900"><%= @company_info["CompanyInfo"]["Country"] %></span>
          <% end %>

          <% if @company_info["CompanyInfo"]["Email"] %>
            <span class="text-gray-600">Email:</span>
            <span class="text-gray-900"><%= @company_info["CompanyInfo"]["Email"]["Address"] %></span>
          <% end %>
        </div>
      </div>
    <% end %>

    <!-- Customers -->
    <% if @customers && @customers["QueryResponse"] && @customers["QueryResponse"]["Customer"] %>
      <div class="p-4 bg-white rounded border border-green-200">
        <h4 class="font-semibold text-gray-900 mb-2">
          Customers (<%= @customers["QueryResponse"]["Customer"].length %>)
        </h4>
        <div class="space-y-2 max-h-64 overflow-y-auto">
          <% @customers["QueryResponse"]["Customer"].first(10).each do |customer| %>
            <div class="flex items-center justify-between p-2 bg-gray-50 rounded text-sm">
              <span class="font-medium text-gray-900"><%= customer["DisplayName"] %></span>
              <span class="text-gray-600 text-xs">ID: <%= customer["Id"] %></span>
            </div>
          <% end %>
          <% if @customers["QueryResponse"]["Customer"].length > 10 %>
            <p class="text-xs text-gray-500 text-center pt-2">
              Showing 10 of <%= @customers["QueryResponse"]["Customer"].length %> customers
            </p>
          <% end %>
        </div>
      </div>
    <% elsif @customers && @customers["QueryResponse"] %>
      <div class="p-4 bg-white rounded border border-green-200">
        <p class="text-gray-600 text-sm">No customers found in QuickBooks.</p>
      </div>
    <% end %>

    <!-- Raw Response Toggle -->
    <details class="mt-4">
      <summary class="cursor-pointer text-sm text-gray-700 font-semibold">View Raw JSON Response</summary>
      <pre class="mt-2 bg-gray-900 text-green-400 p-4 rounded text-xs overflow-x-auto"><%= JSON.pretty_generate({
        company_info: @company_info,
        customers: @customers
      }) %></pre>
    </details>
  </div>
</turbo-frame>
